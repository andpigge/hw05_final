{% extends 'base.html' %}
{% load thumbnail %}


{% block title %}
  Это главная страница проекта Yatube
{% endblock %}


{% block content %}
<div class="information-text information-text_margin_bottom">
  <h1 class="information-text__title">
    Все посты
  {% if username %}
    автора {{ username }}
  {% endif %}
  </h1>
</div>

{% include 'includes/switcher.html' %}

{% if user.is_authenticated %}
  {% with request.resolver_match.view_name as current_url %}
  <div class="row my-3">
    <ul class="nav nav-tabs">
      <li class="nav-item">
        <a 
          class="nav-link {% if current_url == 'posts:follow_index' %}active{% endif %}"
          href="{% url 'posts:follow_index' %}"
        >
          Все посты
        </a>
      </li>

      {% for author in authors %}
        <li class="nav-item">
          <a 
            class="nav-link {% if current_url == 'posts:follow_author' %}active{% endif %}"
            href="{% url 'posts:follow_author' author %}"
          >
            {{ author }}
          </a>
        </li>
      {% endfor %}
    </ul>
  </div>
  {% endwith %} 
{% endif %}

{% for post in page_obj %}
  <ul class='nav flex-column'>
    <li class='nav-item' style="color: #F5556E">
      Автор
      <span style="color: #DEDEDE">
        {% if post.author.get_full_name %}
          &#8213; {{ post.author.get_full_name }}
        {% else %}
          &#8213; {{ post.author }}
        {% endif %}
      </span>
    </li>
    <li class='nav-item' style="color: #F5556E">
      Дата публикации
      <span style="color: #DEDEDE">
        &#8213; {{ post.created|date:'d E Y' }}
      </span>
    </li>
    {% block group %}
      {% if post.group %}
        <li class='nav-item' style="color: #F5556E">
          Группа
          <span style="color: #DEDEDE">
            &#8213; {{ post.group }}
          <span/>
        </li>
      {% endif %}
    {% endblock %}
  </ul>
  <p style="color: #6E6E6E" class='mt-3'>
    {{ post.text|truncatechars:600 }}
  </p>
  <p>
    {% if post.post_edit %}
      Изменено: {{ post.created }}
    {% endif %}
  </p>
  {% thumbnail post.image "740x418" crop="center" upscale=True as image %}
    <img class="card-img my-2" src="{{ image.url }}">
  {% endthumbnail %}
{% empty %}
  <p>Пока нет записей.</p>
{% endfor %}
{% endblock %}
